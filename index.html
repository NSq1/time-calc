---
layout: default
toc: false
---
<script>{% include time_calc_customize.js %}</script>
<table>
    <tr><td><table>
        <tr><th>FROM</th><th>TO</th></tr>
        <tr>
            <td><input id="from" class="from date" type="text"/>&nbsp;<input class="from time" type="text"/>
            <input class="from now" type="button" value="NOW"/></td>
            <td><input id="to" class="to date" type="text"/>&nbsp;<input class="to time" type="text"/>
            <input class="to now" type="button" value="NOW"/></td>
        </tr>
    </table></td></tr>  
    <tr><td id="output"></td></tr>
</table>
<script>
$.getScript('//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js', function(){
    $(".time").timepicker({
    timeFormat: 'HH:mm:ss',
    dynamic: false,
    dropdown: true,
    scrollbar: true,
    change: function(time){refreshOutput();}
});
});
$.getScript('assets/js/jquery-ui.js', function(){
    $( ".date" ).datepicker({
        dateFormat: "yy-mm-dd"
    }); 
});
var timeBase = {
    ms : 1,
    s : 1000,
    m : 1000*60,
    h : 1000*60*60,
    d : 1000*60*60*24,
    mm : 1000*60*60*24*30,
    y : 1000*60*60*24*365,
}
var getFrom = function(){
    let result = new Date(Date.parse($('.from.date').val()));
    let deltaTime = $('.from.time').val().split(':');
    let hours = deltaTime[0]!=='' ? deltaTime[0] : 0;
    let minutes = deltaTime.length>0 ? deltaTime[1] : 0;
    let seconds =  deltaTime.length>1 ? deltaTime[2] : 0;
    return new Date(result.setHours(hours, minutes, seconds));
};
var getTo = function(){
    let result = new Date(Date.parse($('.to.date').val()));
    let deltaTime = $('.to.time').val().split(':');
    let hours = deltaTime[0]!=='' ? deltaTime[0] : 0;
    let minutes = deltaTime.length>0 ? deltaTime[1] : 0;
    let seconds =  deltaTime.length>1 ? deltaTime[2] : 0;
    return new Date(result.setHours(hours, minutes, seconds));
};
var formatter = function(timestamp){
    let dt = new Date(timestamp);
    return dt.toISOString(); 
};
var formatDate = function(timestamp){
    let dt = new Date(timestamp);
    return dt.getUTCFullYear() + '-' 
        + (dt.getUTCMonth()+1 < 10 ? '0'+(dt.getUTCMonth()+1) : dt.getUTCMonth()+1) + '-' 
        + (dt.getUTCDate()<10 ? '0'+dt.getUTCDate() : dt.getUTCDate());
}
var formatTime = function(timestamp){
    let dt = new Date(timestamp);
    return (dt.getUTCHours() < 10 ? '0'+dt.getUTCHours() : dt.getUTCHours()) + ':'
        + (dt.getUTCMinutes() < 10 ? '0'+dt.getUTCMinutes() : dt.getUTCMinutes()) + ':'
        + (dt.getUTCSeconds() < 10 ? '0'+dt.getUTCSeconds() : dt.getUTCSeconds()) ;
}
var getTimerType = function(){
    return (getFrom().getTime()<getTo().getTime()?'future':getFrom().getTime()>getTo().getTime()?'past':'now');
}
var timer = function(){
    if ($('#to').val()=='' || $('#from').val()==''){return 0;}
    let from = getFrom().getTime();
    let to = getTo().getTime();
    return from > to ? from - to : to - from;
}
var output = function(input){
    try{
    var ms = Math.floor((input%timeBase.s)/timeBase.ms);
    var s = Math.floor((input%timeBase.m)/timeBase.s);
    var m = Math.floor((input%timeBase.h)/timeBase.m);
    var h = Math.floor((input%timeBase.d)/timeBase.h);
    var d = Math.floor((input)/timeBase.d);
    return  '<table>'
        +   '<tr><th rowspan="2">GMT</th><td>from:</td><td colspan="3"> '+ getFrom() +'</td></tr>'
        +   '<tr><td>to:</td><td colspan="3"> '+ getTo() +'</td></tr>'
        +   '<tr><th rowspan="2">ISO</th><td>from:</td><td colspan="3"> '+ getFrom().toISOString() +'</td></tr>'
        +   '<tr><td>to:</td><td colspan="3"> '+ getTo().toISOString() +'</td></tr>'
        +   '<tr><th rowspan="6">OUTPUT</th><td>type:</td><td colspan="3">'+getTimerType()+'</td></tr>'
        +   '<tr><td>days:</td><td>'+Math.floor(input/timeBase.d)+'<td><td>with '+h+'[hours] '+m+'[minutes] '+s+'[s] '+ms+'[ms]</td></tr>'
        +   '<tr><td>hours:</td><td>'+Math.floor(input/timeBase.h)+'<td><td>with  '+m+'[minutes] '+s+'[s] '+ms+'[ms]</td></tr>'
        +   '<tr><td>minutes:</td><td>'+Math.floor(input/timeBase.m)+'<td><td>with  '+s+'[s] '+ms+'[ms]</td></tr>'
        +   '<tr><td>seconds:</td><td>'+Math.floor(input/timeBase.s)+'<td><td>with  '+ms+'[ms]</td></tr>'
        +   '<tr><td>miliseconds:</td><td>'+input+'</td><td></td><td></td></tr>'
        +   '</table>';
    } catch (e){return 'one of dates is invalid!<pre>' + e + '</pre>'}
}
var refreshOutput = function(){
    $('#output').html(output(timer()));
}
$('.from, .to').on(
    'change', 
    function(){
        refreshOutput();
    });
$('#from_now');
$('.now').on(
    'click',
    function(){
        $(this).parent().find('.date')
            .val(formatDate($.now()))
            .trigger('change')
            .parent().find('.time')
            .val(formatTime($.now()))
            .trigger('change');
    })
    .trigger('click');
</script>